<!DOCTYPE html>
<style type="text/css">
    .droot{
         width:100%;
         height:auto;
         background:#f5f6fa;
         display:flex;          
         justify-content:center;
         align-items:center;         
            }
    .dsubdivision{
                   width:1500px;
                   height:auto;
                   background:#7f8fa6;
                   border-radius: 15px;                    
                   padding:15px;
                      }
    .dhead{
          font-size:20px;
          font-weight:bold;
          letter-spacing: 2px;
          color:#000;
          display:flex;          
          align-items:center;
          padding:5px;
                     

             }
    .root{
         width:100%;
         height:100vh;
         background:#f5f6fa;
         display:flex;          
         justify-content:center;
         align-items:center;         
            }
    .subdivision{
                   width:1500px;
                   height:auto;
                   background:#7f8fa6;
                   border-radius: 15px;                    
                   padding:15px;
                      }
    .head{
          font-size:20px;
          font-weight:bold;
          letter-spacing: 2px;
          color:#FFF;
          display:flex;
          align-items:center;
          padding:5px;
                     

             } 
    
    .tbtexthead{
        
        color:#fff;
        font-size:20px;
        font-weight:bold;
    } 
    .tbtext{
        
        color:#fff;   
        font-weight:bold;
        font-size:18px;
    } 
</style>            
<html>
  <head>
  <!--Import Google Icon Font-->

  <title>Doctor Display</title>
<!-- Font Awesome -->
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
  rel="stylesheet"
/>
<!-- Google Fonts -->
<link
  href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
  rel="stylesheet"
/>
<!-- MDB -->
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.css"
  rel="stylesheet"
/><!-- MDB -->
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" ></script>/>
</head>
   <body>
        <div class="root">
            <div class="subdivision">
            
                <div class="head" >  
                               
                    
                      Doctor's List
                </div>
                            
                
            
            <table class="table align-middle">
            <thead class="tbtexthead">
              <tr>
                <th scope="col">Id</th>
                <th scope="col">Name</th>
                <th scope="col">Dob</th>
                <th scope="col">Gender</th>
                <th scope="col">Mobileno</th>
                <th scope="col">EmailAddress</th>
                <th scope="col">Speciality</th>
                <th scope="col">Picture</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody class="tbtext">
                {% for row in result %}
                <tr>
                <th scope="row">{{ row.DoctorId}}</th>
                <td>{{ row.Doctorname }}</td>
                <td>{{ row.Dob }}</td>
                <td>{{ row.Gender }}</td>
                <td>{{ row.Mobileno }}</td>
                <td>{{ row.Emailaddress }}</td>
                <td>{{ row.tspecialization }}</td>  
                <td><button type="button" drid={{row.DoctorId}} dricon={{ row.Profilepicture }} drdb={{row.Dob}} drgr={{row.Gender}} drmb={{row.Mobileno}} dreml={{row.Emailaddress}} drspc={{row.Speciality}} class="btnicon btn-light btn-sm px-3" data-ripple-color="dark" data-mdb-target="#iconModal">
                                 
                  <img src="/static/{{row.Profilepicture}}"                  
                  style="width:80px";
                  /> 
                </button>                  
                </td>                            
                <td>
                  <button type="button" drid={{row.DoctorId}} drname='{{ row.Doctorname }}' drdb={{row.Dob}} drgr={{row.Gender}} drtspc="{{row.tspecialization}}" drmb={{row.Mobileno}} dreml={{row.Emailaddress}} drspc={{row.Speciality}} class="btnedit btn-light btn-sm px-3" data-ripple-color="dark" data-mdb-toggle="modal" data-mdb-target="#exampleModal">
                    <i class="fas fa-edit"></i>
                  </button>        
                </td>
              </tr>   
                {% endfor %}           
            </tbody>
            </table>
            </div>
        </div>
        <!--Dialog-->
        <!-- Modal -->
 <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title dhead" id="exampleModalLabel">
          <span><img src="/static/logo1.png" width="40px;"></span>
          <span style="padding-left:10px;">
              Doctor Registration
          </span>
        </div>
        <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">        
          <div class="droot">
          <div class="dsubdivision">
            <div class="row" style="margin-top:6px">
                  <div class="col-12">
                       <div class="form-outline form-white">
                         <input type="text" id="drsid" name="drsid" class="form-control form-control-lg" />
                          <label class="form-label" for="drs">Doctor Id</label>
                         </div>
                     </div>
              </div>             
                       
              <div class="row" style="margin-top:6px">
                  <div class="col-12">
                       <div class="form-outline form-white">
                         <input type="text" id="drs" name="drs" class="form-control form-control-lg" />
                          <label class="form-label" for="drs">Doctor's Name</label>
                         </div>
                     </div>
              </div>
              <div class="row" style="margin-top:6px">
                  <div class="col-12">
                       <div class="form-outline form-white" style="color:white;">                          
                         <input type="date" id="drdob" name="drdob" class="form-control form-control-lg"/>
                         <label class="form-label" style="color:white" for="drdob"> Date Of Birth</label>                          
                         </div>
                     </div>
              </div>
              <div class="row" style="margin-top:6px">
                  <div class="col-12">
                        <label class="form-check-label" style="color:white" for="inlineRadio1">Doctor Gender: </label>
                       <div class="form-check form-check-inline">
                          
                         <input class="form-check-input" type="radio" name="drg" id="drg" value="Male" />
                         <label class="form-check-label" style="color:white" for="inlineRadio1">Male</label>
                       </div>

                   <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="drg" id="drg" value="Female" />
                       <label class="form-check-label" style="color:white" for="inlineRadio2">Female</label>
                   </div>

                  <div class="form-check form-check-inline form-white">
                     <input class="form-check-input" type="radio" name="drg" id="drg" value="Others"/>
                    <label class="form-check-label" style="color:white" for="inlineRadio3">Others</label>
                 </div>
                       </div>
              </div>
               <div class="row" style="margin-top:6px">
                  <div class="col-12">
                       <div class="form-outline form-white">
                         <input type="email" id="drem" name="drem" class="form-control form-control-lg" />
                          <label class="form-label" for="drem">Doctor Email</label>
                         </div>
                     </div>
              </div>
               <div class="row" style="margin-top:6px">
                  <div class="col-12">
                       <div class="form-outline form-white">
                         <input type="number" id="drmo" name="drmo" class="form-control form-control-lg"/>
                          <label class="form-label" style="color:white" for="drmo">Doctor Mobile NO:</label>
                         </div>
                     </div>
              </div>
                 
               <div class="row" style="margin-top:6px">
                  <div class="col-12">
                       <div class="form-outline form-white">
                             <label class="form-label" style="color:white" for="drmo">Doctor Specialization:</label>
                             <select name="specialization" id="spld" class="form-select">                                                                                         
                              </select>
                         </div>
                     </div>
              </div>
                             <div class="row" style="margin-top:10px">
              <div class="col-6">
                <button type="button" class="updbtn btn-light" style="width:100%; font-weight:bold; font-size:14px;" data-mdb-ripple-color="dark">Update</button>
                </div>
                <div class="col-6">
                  <button type="button" class="delbtn btn-light" style="width:100%; font-weight:bold; font-size:14px;" data-mdb-ripple-color="dark">Delete</button>
                  </div>
   
              </div>
              <div class="row" style="margin-top:6px">
                <div class="col-12" id="msg" style="color:#FFF; font-size:24px;">
                               
                </div>
              </div>            
             </div>
           </div>
      </div>      
      </div>
      
    </div>
    <div class="modal fade" id="iconModal" tabindex="-1" aria-labelledby="iconModalLabel" aria-hidden="true">
      <div class="modal fade" id="iconModal ">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title dhead" id="iconModalLabel">
              <span><img src="/static/logo1.png" width="40px;"></span>
              <span style="padding-left:10px;">
                  Doctor Registration
              </span>
            </div>
            <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body"style="display:flex justify-content:center align-items:center"> 
            <div class="droot">
            <div class="dsubdivision">   
              <div class="row" style="margin-top:4px;">
                <div class="col-12">
                    <div class="form-outline form-white"> 
                      <input type="text" name="Doctorid" id="doid" class="form-control form-control-lg" />
                      <label class="form-label" for="spl">Doctor Id</label>
                    </div>
                    
                </div>
             </div>
            
            <div class="row" style="margin-top:10px">
                <div class="col-6" style="display:flex; justify-content:center; align-items:center">
            <img 
            id="dcicon"
            class="rounded-3"
            style="width:200px;"
            alt="Avatar"
            />
          </div>
            <div class="col-6" style="display:flex; justify-content:center; align-items:center">
            <img 
            src="/static/edit.jpg"  
            id="editicon"
            class="rounded-3"
            style="width:200px;"
            alt="Avatar"
            />         
           </div>        
          </div>
          <div class="row" style="margin-top:10px;">
              <div class="col-12">
                  
                    <input name="icon" class="form-control form-white form-control-lg" id="icon" type="file"/>
                 
              </div>
            </div>
            <div class="row" style="margin-top:10px;">
              <div class="col-12">
                 <button type="button" style="width:100%;" class="updiconbtn btn-light btn-lg" data-mdb-ripple-color="dark">UPDATE ICON</button>
              </div>
              </div> 
              <div class="row" style="margin-top:4px;">
              <div style="text-align:center; color:#fff; font-size:18px;" id="iconmsg" class="col-12" >
              
              </div>
           </div>         
          </div>
         </div>
        </div>
      </div>
    </div>
  

   
    
<script>
$('.btnedit').click(function(){


$('#iconModal').modal('show')
$('#exampleModal').modal('show')
$('#drsid').val($(this).attr('drid'))
$('#drs').val($(this).attr('drname'))
$('#drdob').val($(this).attr('drdb'))
$('#drg').val($(this).attr('drgr'))
$('#drem').val($(this).attr('dreml'))
$('#drmo').val($(this).attr('drmb'))
$('#spld').append($('<option>').text($(this).attr('tdrspc')).val($(this).attr('drspc')))
  $.getJSON('/specializationdisplayJSON',function(data){
    
    data.result.map((item)=>{
    $('#spld').append($('<option>').text(item.specialization).val(item.specializationid))

    })

})


})

$('.updbtn').click(function(){
  $.getJSON('/Updatedoctor',{'drcid':$('#drid').val(),'drcs':$('#drs').val()},function(data)
  { if(data.result){
    $("#msg").html("Record Updated Successfully")
  }
  else
  {$("#msg").html("Failed To Update Record...")}
  })
  
})
$('.delbtn').click(function(){
  $.getJSON('/Deletedoctor',{'drcid':$('#drsid').val()},function(data)
  { if(data.result){
    $("#msg").html("Record Deleted Successfully")
  }
  else
  {$("#msg").html("Failed To Delete Record...")}
  })
  
})
$('.btn-close').click(function(){
  location.href="http://127.0.0.1:8000/displayalldoctor"


})
$('.btnicon').click(function(){
  $('#exampleModal').modal('hide')
  $('#iconModal').modal('show')
  $('#doid').val($(this).attr('drid'))
  $('#dcicon').attr('src','/static/'+$(this).attr('dricon'))
})
$('#icon').change(function(event){  
  $('#editicon').attr("src",URL.createObjectURL(event.target.files[0])) 
})
$('.updiconbtn').click(function(e){
  var formData=new FormData();
  formData.append("drid",$('doid').val())
  var files=$('#icon')[0].files;
  if(files.length>0){
    formData.append('dricon',files[0]);
    $.ajax({
      url:'/editdoctoricon',
      type:'post',
      headers:{
        "X-CSRGToken": '{{ csrf_token }}'
      },
      data:formData,    
      contentType: false,
      processData: false,
      success:function(response){
        if(response!=0){         
    if(response.result)
    {
      $('#iconmsg').html("ICON Updated Successfully")}
    else{
      $('#iconmsg').html("Fail to Update ICON...")

    }
        }else{
          alert('file not uploaded');
        }
      },
      });
  }else{
    alert("please select a file.");
  }



})




</script>

       

 </body>   
<!--MDB-->
<script type="text/javascript" 
src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.js">
</script>
</html>